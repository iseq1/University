# Подготовка к экзамену  
## Автоматизированное дешифрирование изображений

---

## Оглавление

### 0. Введение
- [0.1 Сцена и изображение](#01-сцена-и-изображение)
- [0.2 Обязательные составные части ОЭС и их назначение](#02-обязательные-составные-части-оэс-и-их-назначение)
- [0.3 Дешифрирование изображений](#03-дешифрирование-изображений)
- [0.4 Причины автоматизации дешифрирования](#04-причины-автоматизации-дешифрирования)
- [0.5 Признаки и их влияние на эффективность дешифрирования](#05-признаки-и-их-влияние-на-эффективность-дешифрирования)
- [0.6 Теоретико-вероятностная модель сцены](#06-теоретико-вероятностная-модель-сцены)

### 1. Случайные поля
- [1.1 Случайное поле на Z<sup>2</sup>. Теорема Колмогорова](#11-случайное-поле-на-z<sup>2</sup>-теорема-колмогорова)
- [1.2 Теорема Колмогорова и ее применение](#12-теорема-колмогорова-и-ее-применение)
- [1.3 Однородные в широком смысле случайные поля](#13-однородные-в-широком-смысле-случайные-поля)
- [1.4 Случайное поле, построенное методом скользящего суммирования](#14-случайное-поле-построенное-методом-скользящего-суммирования)
- [1.5 Сходимости случайных величин](#15-сходимости-случайных-величин)

### 2. Сцены и шумы
- [2.1 Локально однородная сцена и ее изображения](#21-локально-однородная-сцена-и-ее-изображения)
- [2.2 Три типа сцен и их назначение](#22-три-типа-сцен-и-их-назначение)
- [2.3 Аддитивный шум](#23-аддитивный-шум)

### 3. Признаки объектов
- [3.1 Признаки объектов](#31-признаки-объектов)
- [3.2 Признак формы](#32-признак-формы)

### 4. Сегментация
- [4.1 Зона интереса и ее применение](#41-зона-интереса-и-ее-применение)
- [4.2 Сегментация простой зоны](#42-сегментация-простой-зоны)

### 5. Обнаружение объектов
- [5.1 Обнаружение точечных объектов по скалярным изображениям](#51-обнаружение-точечных-объектов-по-скалярным-изображениям)
- [5.2 Обнаружение точечных объектов по векторным изображениям](#52-обнаружение-точечных-объектов-по-векторным-изображениям)

---

## 0. Введение

---

### 0.1 Сцена и изображение

#### Сцена и её объекты

**Сценой** в анализе изображений называется реальный мир или его часть, рассматриваемая в рамках решаемой задачи.  
**Объектами сцены** являются ее составные элементы, выделяемые в соответствии с целью дешифрирования.

Состав объектов сцены зависит от приложения:
- в картографии — рельеф, растительность, гидросеть, застройка;
- в военных задачах — техника, вооружение, инженерные сооружения;
- в других задачах — любые элементы, обладающие отличимыми свойствами.

Обязательное требование к объекту сцены — наличие **индивидуального набора признаков**  
(демаскирующих признаков), отличающих его от других объектов.

---

#### Изображения сцены

**Изображение** — это представление информации о сцене в форме, предназначенной для зрительного восприятия.  
Оно формируется путем изменения отражательных или излучательных свойств **носителя изображения**.

Исторические этапы получения изображений:
- наскальные рисунки (изменение отражательной способности стен);
- ручная живопись и графика;
- камера-обскура (перевернутое оптическое изображение);
- светочувствительные слои и фотография (XIX век);
- оптико-электронные системы (конец XX века).

---

#### Камера-обскура

**Камера-обскура** — прообраз фотоаппарата: свет через отверстие формирует перевернутое изображение сцены.  

Принцип работы:
1. Корпус камеры
Это закрытая коробка или камера, внутрь которой не проникает свет, кроме как через одно отверстие.

2. Маленькое отверстие
На передней стенке камеры проделывается очень маленькое отверстие (апертура). Свет от внешнего объекта проходит через это отверстие.

3. Проекция изображения
Световые лучи от объекта, проходя через маленькое отверстие, образуют инвертированное (перевернутое) и уменьшенное изображение на противоположной внутренней стенке камеры.

4. Экран для наблюдения
Внутренняя сторона камеры служит экраном, на который проецируется изображение.

Принцип камеры-обскуры лёг в основу создания первых фотографических камер и до сих пор используется для обучения основам оптики.

---

#### Светочувствительный слой и фотография 

Светочувствительный слой и фотография в контексте камеры-обскуры — это следующий этап развития устройства, который позволяет не просто наблюдать проекцию изображения, а фиксировать его на плёнке или другом носителе.

Светочувствительный слой:

- Это специальный материал, обычно содержащий химические вещества (например, галогениды серебра), который реагирует на воздействие света.
- Под действием света в этом слое происходят химические изменения — формируется латентное изображение (слабая, невидимая первичная проекция).

Роль в фотографии:

- В камере-обскуре свет проецируется через отверстие на светочувствительный слой.
- Эти химические изменения фиксируют изображение, которое затем проявляют в фотолаборатории специально — проявитель и закрепитель превращают латентное изображение в видимое и стабильное.

Значение для развития фотографии:

- Светочувствительный слой был ключевым изобретением, позволившим перейти от простого наблюдения проекций к записи и сохранению изображений.
- Именно он превратил камеру-обскуру в первую настоящую фотокамеру, обеспечив возможность делать фотоснимки.
---

### 0.2 Обязательные составные части ОЭС и их назначение

**Оптико-электронная система (ОЭС)** — техническое средство получения изображений, включающее три обязательные части:

1. **Фотоприемное устройство (ФПУ)**  
2. **Оптическая система (ОС)**  
3. **Устройство отображения (УО)**  

---

#### Фотоприемное устройство

ФПУ представляет собой **матрицу светочувствительных элементов** (сенсоров):
- форма сенсора обычно квадратная;
- размеры: от нескольких до десятков микрометров;
- матрица имеет `h × w` элементов;
- произведение `h·w` — **разрешение матрицы**.

Каждый сенсор преобразует падающее электромагнитное излучение в электрический сигнал. Качество ФПУ влияет на чувствительность, уровень шумов и разрешение системы.

Примеры ФПУ: ПЗС-матрицы (CCD), КМОП-матрицы (CMOS), фотодиоды.

---

#### Оптическая система

Оптическая система предназначена для формирования изображения объекта на фотоприёмнике.
Основные задачи:
1. сбор и фокусировка светового потока;
2. формирование изображения требуемого масштаба;
3. коррекция оптических искажений (аберраций).

К оптической системе относятся объективы, линзы, зеркала, фильтры.

Характеристики: фокусное расстояние, светосила, поле зрения.

---

#### Устройство отображение

Устройство отображения предназначено для визуального представления обработанного изображения пользователю.

Основные функции:
1. преобразование электрического или цифрового сигнала в визуальное изображение;
2. отображение результатов обработки.

Качество отображения определяется разрешением, яркостью, контрастом и цветопередачей
Примеры: монитор, дисплей, проектор, визир.

---

#### Цифровое изображение

**Пиксель** — тройка чисел:
$$
(i, j, x_{ij})
$$
где `(i, j)` — координаты, `x_{ij}` — амплитуда сигнала.

Совокупность всех пикселей образует **цифровое изображение**.

**Цифровое изображение** — это представление изображения в виде дискретной двумерной матрицы элементов (пикселей), каждому из которых соответствует числовое значение яркости или цвета.

Основные характеристики:
1. пространственное разрешение (число пикселей);
2. глубина квантования (битность);
3. цветовая модель (градации серого, RGB и др.).

Цифровые изображения являются основной формой данных в системах цифровой обработки изображений.

---

#### Элементарное поле зрения ОЭС

**Элементарное поле зрения** (мгновенный угол поля зрения) — пространственный угол, излучение в пределах которого воспринимается одним элементом матрицы.

При малых углах выполняется приближение:

$$
\alpha \approx \frac{d}{f}
$$

где  
- `d` — размер стороны сенсора,  
- `f` — фокусное расстояние оптической системы.


Проекция одного пикселя на сцену — квадрат со стороной:

$$
\Delta = \alpha \cdot R
$$

где `R` — расстояние до сцены.

---

#### Разрешающая способность

**Разрешающая способность** — способность ОС формировать раздельные изображения близко расположенных объектов.

- угловой предел разрешения ≥ элементарного поля зрения;
- линейный предел разрешения ≥ `Δ`.

Для глаза человека угловой предел ≈ 1 угловая минута.

Характеризует:
1. максимальное количество различимых деталей;
2. качество изображения
    
---

#### Предел разрешения 

Предел разрешения — это минимальное расстояние между двумя точками объекта, при котором они ещё различимы как отдельные.

Ограничивается:
1. дифракцией света;
2. аберрациями оптической системы;
3. размером пикселей фотоприёмника.

Даже при идеальной обработке изображение не может превысить физический предел разрешения системы.

---

#### Масштаб изображения

Масштаб цифрового изображения определяет соотношение между размерами объекта в реальном пространстве и его изображением в пикселях.

Зависит от:
1. фокусного расстояния объектива;
2. расстояния до объекта;
3. размера пикселя матрицы.

Масштаб важен при измерениях по изображению и анализе геометрических параметров объектов

Масштаб изображения определяется как:

$$
M = \frac{f}{R}
$$

Он связывает размеры объекта на сцене и на изображении.

---

#### Оптический диапазон
Оптический диапазон — это диапазон длин волн электромагнитного излучения, воспринимаемых ОЭС.

Оптический диапазон включает:
- ультрафиолет;
- видимый диапазон (0.4–0.8 мкм);
- инфракрасный диапазон (0.8–1000 мкм).

В видимом диапазоне признак — **отражательная способность**,  
в инфракрасном — **собственное тепловое излучение**.

---

### 0.3 Дешифрирование изображений

#### Определение дешифрования

**Дешифрирование** — получение информации о сцене по ее изображению.

Основные задачи дешифрирования:
- **обнаружение** объектов;
- **поиск** объектов;
- **сегментация** изображения;
- **классификация** объектов.

**Обнаружение** — принятие решения о наличии объекта заданного класса в указанном месте сцены.
Обнаружение считается правильным, если предполагаемый объект перекрывает реальный.

**Сегментация** — разбиение изображения сцены на изображения отдельных объектов.

**Поиск объектов** — последовательный перебор возможных мест их расположения с применением процедуры обнаружения.

**Классификация** — отнесение обнаруженного объекта к одному из заданных классов или подклассов.

Эффективность методов оценивается вероятностями:
- правильного обнаружения;
- ложного обнаружения;
- пропуска;
- правильной классификации.

Дешифрирование может быть:
* визуальным, основанным на опыте и знаниях оператора;
* автоматизированным, выполняемым алгоритмами цифровой обработки изображений; 
* комбинированным, при котором оператор корректирует результаты автоматической обработки.

Процесс дешифрирования широко применяется в дистанционном зондировании Земли, техническом зрении, медицине, робототехнике и системах наблюдения.

---

#### Обнаружение, поиск и классификация объектов

Процесс анализа объектов на изображении обычно включает несколько последовательных этапов.

**Обнаружение объектов** заключается в определении наличия объектов определённого типа на изображении. На этом этапе не требуется точного описания формы или принадлежности объекта к классу — важен сам факт его существования. Обнаружение основывается на анализе характерных признаков объекта, отличающих его от фона.

**Поиск объектов** представляет собой уточнение местоположения обнаруженных объектов в пределах изображения. В результате поиска определяются координаты, размеры и ориентация объекта. Поиск может выполняться как в локальных областях, так и по всему изображению.

**Классификация объектов** — это этап, на котором объекту присваивается определённый класс или категория. Классификация проводится на основе совокупности признаков:
- спектральных (яркость, цветовые характеристики); 
- геометрических (форма, размеры); 
- текстурных (однородность, зернистость); 
- контекстных (окружение, взаимосвязь с другими объектами).

Классификация может быть:
- основанной на заранее заданных правилах;
- статистической;
- с применением методов машинного обучения и нейронных сетей.

---

#### Сегментация изображений

Сегментация изображений — это процесс разделения изображения на отдельные области, однородные по определённым признакам, соответствующие объектам или их фрагментам.

Основное назначение сегментации:
- выделение объектов из фона;
- структурирование изображения;
- снижение сложности дальнейшего анализа.

Сегментация основывается на следующих принципах:
- различие между объектами и фоном;
- сходство пикселей внутри одного сегмента;
- пространственная связность элементов изображения.

Основные методы сегментации:
- пороговая сегментация, основанная на сравнении яркости с заданным порогом;
- сегментация по границам, при которой выделяются резкие изменения яркости;
- региональные методы, основанные на объединении пикселей в области;
- кластерные методы, использующие статистические характеристики.

Результатом сегментации является изображение, в котором каждый пиксель принадлежит определённому сегменту, что служит основой для дальнейших этапов дешифрирования — обнаружения, поиска и классификации объектов.

---

### 0.4 Причины автоматизации дешифрирования

Автоматизация дешифрирования изображений обусловлена ростом объёмов визуальной информации, усложнением изображений и ограниченными возможностями человека при их анализе. Применение автоматических и автоматизированных методов позволяет повысить эффективность, объективность и точность обработки изображений.

---

#### Система жизнеобеспечения

Человек-оператор является частью системы дешифрирования, однако его возможности ограничены физиологическими и психологическими факторами. При длительной работе с изображениями наблюдаются:
- утомляемость;
- снижение концентрации внимания;
- ухудшение точности восприятия;
- рост вероятности ошибок.

Автоматизация позволяет снизить нагрузку на оператора и исключить его постоянное участие в рутинных операциях. В системах жизнеобеспечения оператора (освещение, эргономика рабочего места, режим труда) невозможно полностью устранить влияние усталости, поэтому автоматическое дешифрирование обеспечивает более стабильные и воспроизводимые результаты.

---

#### Субъективность или человеческий фактор

Результаты визуального дешифрирования зависят от индивидуальных особенностей оператора:
- опыта и квалификации;
- психофизиологического состояния;
- уровня внимания и мотивации.

Разные специалисты могут по-разному интерпретировать одно и то же изображение, что приводит к субъективности и низкой воспроизводимости результатов.
Автоматизация дешифрирования позволяет:
- снизить влияние субъективных факторов;
- обеспечить единые критерии анализа;
- повысить объективность и повторяемость результатов.

Алгоритмы обработки изображений выполняют анализ по формализованным правилам и параметрам, что исключает индивидуальные интерпретации.

---

#### Скорость восприятия

Человеческое зрение обладает ограниченной скоростью обработки информации. При анализе большого количества изображений или сложных сцен оператор не способен обеспечить требуемую скорость принятия решений.

Автоматизированные системы:
- обрабатывают изображения в реальном или близком к реальному времени;
- способны анализировать большие массивы данных;
- обеспечивают оперативность обнаружения и классификации объектов.

Это особенно важно в задачах мониторинга, навигации, видеонаблюдения и дистанционного зондирования, где задержка обработки может привести к потере актуальной информации

---

#### Многоспектральность

Современные оптико-электронные системы формируют изображения в различных спектральных диапазонах (видимый, инфракрасный, ультрафиолетовый и др.). Человек способен непосредственно воспринимать только ограниченную часть спектра — видимый диапазон.

Автоматическое дешифрирование позволяет:
- обрабатывать многоспектральные и гиперспектральные данные;
- анализировать скрытые спектральные признаки объектов;
- выявлять объекты, незаметные при визуальном наблюдении.

Математические методы позволяют объединять информацию из разных спектральных каналов и повышать достоверность распознавания

---

#### Математическая модель и её роль

Математическая модель в автоматическом дешифрировании представляет собой формализованное описание изображения, объектов и процессов их формирования.

Роль математической модели:
- описание свойств объектов и фона;
- моделирование процессов формирования изображения;
- формализация признаков для обнаружения и классификации объектов;
- разработка и оптимизация алгоритмов обработки.

Использование математических моделей позволяет:
- перейти от субъективного анализа к количественной оценке;
- применять методы статистики, оптимизации и машинного обучения;
- прогнозировать качество дешифрирования и устойчивость алгоритмов.

Математическая модель является основой для построения автоматизированных и интеллектуальных систем дешифрирования изображений.

---

### 0.5 Признаки и их влияние на эффективность дешифрирования

В процессе дешифрирования изображений ключевую роль играют признаки объектов, по которым осуществляется их обнаружение, распознавание и классификация. Признаки позволяют формализовать визуальные характеристики объектов и перевести их в количественную форму, пригодную для автоматической обработки.

**Признак** — измеримая характеристика объекта, используемая для его обнаружения и классификации.

Эффективность дешифрирования напрямую зависит от правильного выбора и сочетания признаков, а также от соответствия признаков типу анализируемых объектов и условиям съёмки.

---

#### Точечные и протяжённые объекты

В зависимости от размеров и формы объектов на изображении различают точечные и протяжённые объекты.

Точечные объекты — это объекты, размеры которых сопоставимы с размером одного или нескольких пикселей.
Примеры: отдельные источники света, мелкие объекты, удалённые цели.
Особенности дешифрирования:

- ограниченный набор признаков;
- основное значение имеют яркость и спектральные характеристики;
- геометрическая форма выражена слабо.

Протяжённые объекты — это объекты, занимающие значительную область изображения.
Примеры: дороги, здания, водоёмы, лесные массивы.
Особенности дешифрирования:
- используются геометрические, текстурные и групповые признаки;
- возможно более точное описание формы и структуры;
- выше надёжность классификации.

Тип объекта определяет набор применяемых признаков и методы анализа.

---

#### Геометрические, текстурные, групповые, и спектральные признаки

**Геометрические признаки** описывают форму и пространственные характеристики объекта.

К ним относятся:

- размеры (площадь, длина, ширина);
- форма (контур, вытянутость, компактность);
- ориентация в пространстве;
- взаимное расположение частей объекта.

Геометрические признаки особенно эффективны для:
- протяжённых и чётко очерченных объектов;
- задач распознавания искусственных объектов.

Их недостатком является высокая чувствительность к масштабу, искажениям и углу съёмки.

**Текстурные признаки** характеризуют внутреннюю структуру объекта, распределение яркости и неоднородность внутри области изображения.

Основные характеристики текстуры:

- однородность;
- зернистость;
- повторяемость элементов;
- контраст.

Текстурные признаки особенно полезны для:
- распознавания природных объектов (лес, вода, почва);
- анализа объектов с нечеткими границами.

Они менее чувствительны к форме, но зависят от разрешения изображения и уровня шума.

**Групповые признаки** описывают не отдельный объект, а совокупность объектов и их взаимное расположение.

К ним относятся:
- плотность объектов;
- регулярность размещения;
- пространственные связи;
- контекст окружающей среды.

Групповые признаки важны при дешифрировании сложных сцен, где отдельный объект трудно выделить изолированно.
Они позволяют использовать контекстную информацию и повышают достоверность классификации

**Спектральные признаки** основаны на различии объектов по отражательной способности или излучению в разных спектральных диапазонах.

К ним относятся:
- значения яркости в отдельных спектральных каналах;
- спектральные индексы;
- соотношения между каналами.

Спектральные признаки:
- являются основными при многоспектральной съёмке;
- позволяют различать объекты с похожей формой, но разным физическим составом;
- мало зависят от геометрии объекта.

Их эффективность снижается при плохих условиях съёмки и сильном шуме.

**Эффективность дешифрирования** определяется:
- информативностью признаков;
- устойчивостью к шумам и искажениям;
- соответствием задачам и типу объектов;
- возможностью автоматической формализации.

На практике используется комбинация различных признаков, что позволяет компенсировать недостатки отдельных групп и повысить точность обнаружения и классификации объектов.

---

### 0.6 Теоретико-вероятностная модель сцены

Для автоматического дешифрирования и анализа изображений необходимо формализованное описание сцены и процессов формирования изображения. В этой связи широко применяются теоретико-вероятностные модели, позволяющие учитывать неопределённость, шумы и изменчивость реальных объектов

#### Детерминированные и вероятностные модели

**Детерминированные модели** описывают сцену и изображение как полностью определённые системы, в которых каждому входному параметру соответствует однозначный результат.

Особенности детерминированных моделей:
- параметры сцены считаются известными и неизменными;
- отсутствует случайность;
- результат обработки строго повторяем.

Детерминированные модели применяются:
- при анализе идеализированных изображений;
- для описания геометрии объектов;
- в задачах, где влияние шумов минимально.

Недостатком детерминированного подхода является его ограниченная применимость к реальным изображениям, которые всегда содержат шумы и искажения.

**Вероятностные модели** учитывают случайный характер формирования изображения и неопределённость параметров сцены.

Основные особенности:
- параметры описываются случайными величинами;
- учитываются шумы, помехи и вариации условий съёмки;
- результаты анализа имеют вероятностный характер.

Вероятностные модели позволяют:
- оценивать достоверность решений;
- учитывать ошибки измерений;
- строить оптимальные алгоритмы обработки и распознавания.

В задачах цифровой обработки изображений вероятностные модели являются более адекватными для описания реальных условий.

---

#### Сцена как случайное поле

Сцена как случайное поле означает, что изображение рассматривается как реализация двумерного случайного процесса, в котором каждому элементу изображения соответствует случайная величина.

Основные положения:
- яркость или цвет пикселя являются случайными величинами;
- статистические характеристики описывают свойства сцены;
- изображение представляет собой одну из возможных реализаций случайного поля.

Для описания случайного поля используются:
- математическое ожидание;
- дисперсия;
- корреляционные функции;
- совместные распределения вероятностей.

Такой подход позволяет:
- моделировать фон и объекты сцены;
- учитывать пространственные зависимости между пикселями;
- разрабатывать методы фильтрации и сегментации.

Рассмотрение сцены как случайного поля является фундаментом для применения статистических и вероятностных методов в дешифрировании изображений.

---

Теоретико-вероятностная модель сцены позволяет:
- формализовать признаки объектов;
- строить оптимальные критерии обнаружения и классификации;
- учитывать неопределённость и шумы при принятии решений.

Использование вероятностных моделей повышает устойчивость алгоритмов и точность дешифрирования по сравнению с детерминированными подходами

---

## 1. Случайные поля

### 1.1 Случайное поле на Z<sup>2</sup>. Теорема Колмогорова

В теории цифровой обработки изображений изображение часто рассматривается как реализация случайного поля, заданного на дискретной двумерной решётке. Такой подход позволяет строго описывать статистические свойства изображений и разрабатывать оптимальные методы их обработки и дешифрирования.

---

#### Определение

Случайное поле на $Z^2$ — это семейство случайных величин
$$
{X(i,j)∣(i,j) ∈ Z^2},
$$
где каждой точке двумерной целочисленной решётки соответствует случайная величина.

В контексте цифровых изображений:
- $(i,j)$ — координаты пикселя;
- $X(i,j)$ — яркость или цвет пикселя;
- вся совокупность значений образует изображение как случайный объект.

Таким образом, цифровое изображение рассматривается не как фиксированная матрица чисел, а как одна реализация случайного поля, сформированного при определённых условиях съёмки.

--- 

#### Свойство совместных распределений

Для полного описания случайного поля необходимо задать совместные распределения вероятностей для всех конечных наборов случайных величин поля.

Пусть выбраны точки:
$$
(i_1, j_1), (i_2, j_2), ..., (i_n, j_n)
$$
Тогда их значения описываются совместным распределением:
$$
P(X(i_1, j_1) ≤ x_1, ..., X(i_n, j_n) <= x_n)
$$
Совместные распределения должны удовлетворять следующим свойствам:

1. Неотрицательность - вероятности неотрицательны.
2. Нормировка - полная вероятность равна 1.
3. Согласованность (маргинальность) - совместные распределения для меньшего числа переменных должны получаться из распределений большего порядка путём интегрирования (или суммирования) по исключаемым переменным.
4. Симметричность - перестановка индексов случайных величин не меняет распределение.

Эти свойства обеспечивают математическую корректность описания случайного поля и являются основой для применения вероятностных методов анализа изображений.

---

#### Выборочная поверхность случайного поля

Выборочная поверхность случайного поля — это конкретная реализация случайного поля, полученная при одном наблюдении.

В случае изображений:
- выборочная поверхность — это конкретное цифровое изображение;
- каждому пикселю соответствует одно реализованное значение случайной величины;
- совокупность этих значений образует дискретную поверхность яркости.

Свойства выборочной поверхности:
- она фиксирована, но является результатом случайного процесса;
- разные реализации одного и того же поля дают разные изображения;
- статистические свойства проявляются только при анализе множества реализаций или пространственных усреднений.

Понятие выборочной поверхности связывает абстрактную вероятностную модель со реальными изображениями, которые используются в обработке и дешифрировании.

---

Теорема Колмогорова о согласованности утверждает, что:

>Если задана система конечномерных совместных распределений, удовлетворяющая условиям согласованности, симметричности и нормировки, то существует случайное поле, для которого эти распределения являются совместными распределениями его значений.

Иными словами:
- достаточно корректно задать все конечномерные распределения;
- при выполнении условий Колмогорова существует случайное поле на $Z^2$;
- это поле определено с точностью до распределения.

Значение теоремы:
- обеспечивает строгую математическую основу для моделирования изображений; 
- позволяет строить вероятностные модели сцены и изображения; 
- гарантирует корректность статистических методов обработки.

Без этой теоремы описание изображения как случайного поля было бы формально необоснованным.

---

### 1.2 Теорема Колмогорова и ее применение

Теорема Колмогорова играет фундаментальную роль в теории вероятностей и является основой для построения вероятностных моделей случайных полей, используемых при описании цифровых изображений. Она устанавливает условия, при которых по заданным конечномерным распределениям можно корректно определить случайное поле.

---

#### Конечномерные распределения

Конечномерные распределения — это совместные распределения вероятностей значений случайного поля в конечном числе точек.

Пусть задано случайное поле:
$$
{X(i,j), (i,j) ∈ Z^2}
$$

Тогда для любого конечного набора точек:

$$
(i_1, j_1), (i_2, j_2), ..., (i_n, j_n)
$$

определяется совместное распределение:
$$
F_{i_1,...,i_n}(x_1,...,x_n) = P(X(i_1, j_1) ≤ x_1, ..., X(i_n, j_n) <= x_n)
$$
Эти распределения полностью описывают статистические свойства случайного поля при условии их согласованности.

---

#### Формулировка теоремы

Теорема Колмогорова о существовании случайного поля формулируется следующим образом:

> Если задана система конечномерных распределений случайных величин, определённых на всех конечных подмножествах индексов, и если эта система удовлетворяет условиям:
> - нормировки;
> - неотрицательности;
> - симметричности;
> - согласованности (маргинальности), 
>
> то существует случайное поле, для которого эти распределения являются конечномерными распределениями.

Иначе говоря, теорема гарантирует, что:
- корректно заданные конечномерные распределения определяют случайное поле;
- не возникает противоречий между распределениями разных порядков;
- такое поле можно использовать в строгой математической модели.

Теорема Колмогорова позволяет:
- строить вероятностные модели изображений и сцен;
- формально определять случайные поля через их статистические характеристики;
- использовать конечномерные распределения вместо задания всей бесконечной совокупности случайных величин.

В практических задачах обработки изображений обычно задаются:
- распределения яркости отдельных пикселей;
- совместные распределения соседних пикселей;
- корреляционные характеристики.

При выполнении условий теоремы можно быть уверенным, что такая модель соответствует реально существующему случайному полю.

---

#### Случайное поле с независимыми в совокупности случайными величинами (пример)

Рассмотрим случайное поле:
$$
{X(i,j) | (i,j) ∈ Z^2 }
$$
в котором все случайные величины независимы в совокупности и имеют одинаковое распределение.

Характеристики такого поля:
- каждое значение яркости не зависит от соседних;
- совместное распределение факторизуется:
$$
P(X_1 = x_1,...,X_n = x_n) = \prod_{k=1}^n P(X_k = x_k)
$$
- корреляция между пикселями отсутствует.

Такое поле часто называют белым шумом.

Значение примера:
- простейшая вероятностная модель изображения;
- используется как модель шума;
- удовлетворяет условиям теоремы Колмогорова автоматически, так как независимость гарантирует согласованность распределений.

На практике реальные изображения не являются независимыми, однако данный пример важен как базовая модель и отправная точка для построения более сложных случайных полей.

---

### 1.3 Однородные в широком смысле случайные поля

При анализе изображений как случайных полей важную роль играют предположения об их статистических свойствах. Одним из наиболее часто используемых классов являются однородные в широком смысле случайные поля, которые позволяют упростить описание изображений и применять мощные методы статистической обработки.

---

#### Определение однородного в широком смысле случайного поля

Случайное поле называется однородным в широком смысле (или стационарным в широком смысле), если выполняются следующие условия:
1. Математическое ожидание случайного поля постоянно и не зависит от координат:
$$
E[X(i,j)]=m=const
$$
2. Ковариационная функция зависит только от относительного смещения между точками, а не от их абсолютного положения:
$$
Cov\{X(i,j),X(i+Δi,j+Δj)\}=C(Δi,Δj)
$$
Это означает, что статистические свойства поля одинаковы во всех точках пространства.

---

#### Ковариационная функция: определение

Ковариационная функция случайного поля характеризует степень статистической зависимости между значениями поля в разных точках.

Для случайного поля $X(i,j)$ ковариационная функция определяется как:
$$
C(i_1, j_1, i_2, j_2)=E[(X(i_1, j_1)−m)(X(i_2, j_2)−m)]
$$
В случае однородности в широком смысле она упрощается до функции смещения:
$$
C(Δi,Δj)
$$
Ковариационная функция описывает пространственную структуру поля и отражает степень корреляции между пикселями изображения.

---

#### Свойства ковариационной функции

Ковариационная функция обладает рядом фундаментальных свойств, которые важны как с теоретической, так и с практической точки зрения.

1. Симметричность
$$
C(Δi,Δj)=C(−Δi,−Δj)
$$
Это свойство отражает взаимность статистической зависимости между точками.


2. Максимум при нулевом смещении
$$
C(0,0)=σ^2
$$
Значение ковариационной функции в нуле равно дисперсии случайного поля. Это максимальное значение ковариации.


3. Ограниченность
$$
∣C(Δi,Δj)∣≤C(0,0)
$$
Ковариация между различными точками не может превышать дисперсию.


4. Положительная полуопределённость - для любого конечного набора коэффициентов $a_k$ выполняется:
$$
\sum_{k,l} a_k \cdot a_l \cdot C(Δ_{kl}) ≥ 0
$$
Это свойство гарантирует существование случайного поля с заданной ковариационной функцией.


5. Убывание с ростом расстояния - на практике ковариационная функция убывает при увеличении расстояния между точками, что отражает ослабление корреляции между удалёнными пикселями

---

#### Физический и прикладной смысл ковариационной функции

В обработке изображений ковариационная функция:
- описывает степень однородности изображения;
- позволяет отличать фон от объектов;
- используется при построении фильтров (например, оптимальных линейных фильтров);
- характеризует текстуру изображения.

Однородность в широком смысле часто используется как допущение для описания фона изображения.

---

### 1.4 Случайное поле, построенное методом скользящего суммирования

Метод скользящего суммирования является одним из базовых способов построения случайных полей с заданными корреляционными свойствами. Он широко используется в теории случайных полей и цифровой обработке изображений для моделирования фона, текстур и сглаженных изображений.

---

#### Определение случайного поля, построенного методом скользящего суммирования

Пусть задано исходное случайное поле
$$
\{ξ(i,j)∣(i,j)∈Z^2\}
$$

с независимыми в совокупности случайными величинами, имеющими нулевое математическое ожидание и одинаковую дисперсию:
$$
E[ξ(i,j)]=0,Var[ξ(i,j)]=σ^2
$$

Случайное поле, построенное методом скользящего суммирования, определяется как:
$$
X(i,j)=\sum_{k,l}h(k,l) \cdot ξ(i−k,j−l)
$$

где:

- $h(k,l)$ — весовая функция (ядро суммирования);
- суммирование выполняется по конечной области;
- операция аналогична двумерной свёртке.

Таким образом, каждое значение нового поля формируется как взвешенная сумма значений исходного поля в окрестности точки.

---

#### Интерпретация метода 

Метод скользящего суммирования:

1. вводит корреляцию между соседними значениями поля;
2. сглаживает исходное поле;
3. формирует пространственную структуру.

В контексте обработки изображений этот метод эквивалентен линейной фильтрации изображения с помощью маски (фильтра).

---

#### Ковариационная функция поля скользящего суммирования

Рассмотрим ковариационную функцию:
$$
C_X(Δi,Δj)=Cov\{X(i,j),X(i+Δi,j+Δj)\}
$$
Подставляя определение поля:
$$
X(i,j)=\sum_{k,l}h(k,l) \cdot ξ(i−k,j−l)
$$
и используя независимость исходного поля, получаем:
$$
C_X(Δi,Δj)=σ^2 \sum_{k,l}h(k,l) \cdot h(k−Δi,l−Δj)
$$
Таким образом, ковариационная функция нового поля определяется автокорреляцией весовой функции.

---

#### Свойства ковариационной функции

1. Однородность в широком смысле - ковариационная функция зависит только от смещения $(Δi,Δj)$, следовательно, поле является однородным в широком смысле.
2. Симметричность
$$
C_X(Δi,Δj)=C_X(−Δi,−Δj)
$$
Это свойство следует из симметрии автокорреляции ядра.


3. Максимум в нуле
$$
C_X(0,0)=σ^2 \sum_{k,l}h^2(k,l)
$$
Значение ковариационной функции в нуле равно дисперсии поля и является её максимальным значением.


4. Ограниченность и убывание - ковариационная функция убывает с увеличением расстояния, что определяется размером и формой ядра $h(k,l)$. Чем шире ядро, тем более протяжённой является корреляция.


5. Управляемость свойств - выбирая весовую функцию $h(k,l)$, можно
   - задавать степень сглаживания
   - формировать текстуру
   - управлять пространственными свойствами поля

---

#### Связь с цифровой обработкой изображений

Поле, построенное методом скользящего суммирования:
- моделирует реальные изображения и фоны;
- используется для анализа влияния фильтрации на статистику изображения;
- лежит в основе линейных фильтров (низкочастотных, сглаживающих);
- применяется при синтезе текстур и моделировании шумов.

---

### 1.5 Сходимости случайных величин

В теории вероятностей и статистической обработке изображений важно понимать, как случайные величины (например, значения пикселей или статистики изображения) ведут себя при увеличении объёма данных или при применении функций усреднения. Для этого используют различные виды сходимости.

---

#### Сходимость в среднем квадратическом

**Определение**: Случайная величина $X_n$ сходится к $𝑋$ в среднем квадратическом (или в $L_2$) если:
$$
\lim_{n \rightarrow \infty} E[(X_n - X)^2] = 0
$$
То есть, среднеквадратичная ошибка между $X_n$ и $𝑋$ стремится к нулю при $n \rightarrow \infty$ 

**Особенности:**
- сходимость в среднем квадратическом гарантирует сходимость математического ожидания и дисперсии;
- используется при анализе усреднённых полей и статистик изображения;
- тесно связана с дисперсионным методом оценки параметров.

**Пример:**

Если $X_n$ — среднее значение яркости n пикселей, то при независимых одинаково распределённых пикселях $X_n$ сходится к математическому ожиданию поля в среднем квадратическом с ростом $n$.

---

#### Сходимость по вероятности

**Определение:** Случайная величина $X_n$ сходится к $X$ по вероятности, если для любого $ε>0$:
$$
\lim_{n \rightarrow \infty} P(|X_n - X| > ε) = 0
$$
То есть вероятность отклонения $X_n$ от $X$ на величину больше $ε$ стремится к нулю при $n \rightarrow \infty$

**Особенности:**
- более слабая форма сходимости, чем в среднем квадратическом;
- обеспечивает статистическую стабильность выборочных оценок;
- используется при теоретическом обосновании законов больших чисел.

**Пример:**

Если усреднять значения пикселей по окрестности, то усреднённые величины с большой вероятностью приближаются к истинному значению яркости фона.

---

#### Теорема Слуцкого

Пусть случайные величины $X_n$ сходятся по вероятности к $a$, а $Y_n$ сходятся по вероятности к $b$. Тогда для любых констант $\alpha$, $\beta$ и непрерывной функции $g(\cdot,\cdot):$
1. $ \alpha X_n + \beta Y_n \rightarrow^P \alpha a + \beta b $
2. $ X_n Y_n \rightarrow^P ab $
3. $ \frac{X_n}{Y_n} \rightarrow^P \frac{a}{b}, $ если $ b \neq 0 $
4. $ g(X_n, Y_n) \rightarrow^P g(a,b), $ если $g$ непрерывна в точке $(a,b)$

**Смысл:**
Случайные величины сохраняют свою сходимость по вероятности при линейных и непрерывных комбинациях.

---

#### Следствия из теоремы Слуцкого

1. Если последовательность выборочных средних сходится по вероятности к математическому ожиданию, то любые линейные комбинации этих средних также сходятся по вероятности.
2. Для оценки параметров изображений (например, яркости фона) можно использовать функции от выборочных статистик — результат будет сходимым по вероятности к истинному значению.
3. Теорема обеспечивает математическую основу для построения оценок при больших объемах данных: чем больше пикселей или измерений, тем точнее усреднённая величина отражает истинный параметр.

---

#### Связь с обработкой изображений

- Сходимости позволяют обосновать усреднение пикселей для подавления шума.
- Гарантируют, что статистические характеристики изображения (средняя яркость, дисперсия, контраст) становятся устойчивыми при анализе больших областей.
- Теорема Слуцкого используется при построении фильтров и оценок параметров сцены.

---

## 2. Сцены и шумы

### 2.1 Локально однородная сцена и ее изображения

В цифровой обработке изображений и автоматическом дешифрировании сцена рассматривается как совокупность объектов с различными физическими и статистическими свойствами. Для упрощения анализа часто вводится модель локально однородной сцены, позволяющая эффективно описывать реальные изображения.

---

#### Определение сцены

Сцена — это совокупность объектов и фона, находящихся в поле зрения оптико-электронной системы и формирующих изображение в результате взаимодействия с излучением.

Сцена включает:
- объекты различной природы (искусственные и природные);
- фон;
- условия наблюдения (освещение, геометрия съёмки, спектральный диапазон).

В цифровой обработке изображений сцена описывается через её статистические свойства, отражающиеся в распределении яркостей и других признаков изображения.

---

#### Локально однородная сцена

Локально однородная сцена — это сцена, в которой изображение можно разбить на отдельные области, внутри которых статистические характеристики яркости (математическое ожидание, дисперсия, форма распределения) можно считать постоянными.

Основные предположения:
- внутри каждой области изображение является однородным в широком смысле;
- между различными областями статистические характеристики различаются;
- границы между областями соответствуют границам объектов сцены.

Такая модель хорошо приближает реальные изображения и широко используется в задачах сегментации и распознавания.

---

#### Простые и сложные объекты

**Простые объекты** — это объекты, изображение которых характеризуется однородным распределением яркости внутри объекта.

Особенности:
- малая внутриклассовая вариабельность;
- узкая гистограмма яркостей;
- чётко выраженное среднее значение яркости.

Примеры: однородные поверхности, водные объекты, ровные участки дорог.

**Сложные объекты** состоят из нескольких подэлементов с различными яркостными характеристиками.

Особенности:
- неоднородное распределение яркости;
- широкая или многомодальная гистограмма;
- выраженная текстурная структура.

Примеры: лес, городская застройка, рельеф местности.

---

#### Гистограммы простых и сложных объектов

Гистограмма яркости — это распределение количества пикселей по уровням яркости.

Гистограммы простых объектов:
- имеют один выраженный максимум;
- близки к нормальному распределению;
- легко отделяются от фона по пороговым значениям.

Гистограммы сложных объектов:
- могут иметь несколько пиков;
- часто асимметричны;
- требуют использования текстурных и пространственных признаков.

Гистограммы являются важным инструментом анализа и дешифрирования локально однородных сцен.

---

#### Свойства амплитуд разных объектов 

Простые объекты характеризуются:
- практически постоянной отражательной способностью;
- однородной поверхностью;
- слабо выраженной текстурой.

Амплитудные свойства:
- значения яркости внутри объекта мало различаются;
- дисперсия амплитуд мала;
- распределение яркости обычно одномодальное;
- гистограмма узкая, часто близка к нормальному распределению.

Следствие:
- простые объекты легко выделяются по амплитудному признаку;
- эффективна пороговая сегментация;
- высокая устойчивость к шумам.

Сложные объекты состоят из множества неоднородных элементов и имеют развитую внутреннюю структуру.

Амплитудные свойства:
- яркость значительно изменяется внутри объекта;
- дисперсия амплитуд велика;
- распределение яркости может быть многомодальным;
- гистограмма широкая и асимметричная.

Причины:
- наличие текстуры;
- чередование светлых и тёмных элементов;
- тени и микрорельеф поверхности.

Следствие:
- амплитудный признак недостаточен для надёжного распознавания;
- требуется использование текстурных и пространственных признаков;
- сегментация по яркости усложняется.

---

### 2.2 Три типа сцен и их назначение
В теории цифровой обработки изображений и автоматического дешифрирования принято выделять три типа сцен и соответствующих им изображений. Такое разделение связано с различными источниками данных, степенью приближения к реальности и назначением изображений.

---

#### Реальные сцены и изображения

Реальная сцена — это физически существующая сцена, включающая реальные объекты, фон и условия наблюдения.

Реальное изображение формируется в результате регистрации излучения от сцены с помощью оптико-электронной системы.
Характерные особенности:
- изображение формируется в результате реальных физических процессов;
- присутствуют шумы, искажения, влияние атмосферы и аппаратуры;
- параметры сцены известны не полностью или неизвестны.

Источники реальных изображений:
- аэро- и космическая съёмка;
- видеонаблюдение;
- медицинская визуализация;
- техническое зрение.

Назначение:
- непосредственное наблюдение и анализ объектов;
- практическое дешифрирование и принятие решений;
- получение информации о реальных процессах и объектах.

---

#### Квазиреальные сцены и изображения

Квазиреальная сцена — это искусственно сформированная сцена, параметры которой заданы на основе реальных данных или статистических моделей, приближённых к реальности.

Квазиреальное изображение создаётся путём моделирования процессов формирования изображения с учётом:
- характеристик реальных объектов;
- статистических свойств фона;
- шумов и искажений оптико-электронной системы.

Особенности:
- сцена не существует физически, но статистически близка к реальной;
- параметры сцены и изображения известны;
- допускается управляемое изменение характеристик.

Назначение:
- отладка и тестирование алгоритмов обработки изображений;
- анализ устойчивости методов к шумам и искажениям;
- обучение и проверка систем автоматического дешифрирования.

Квазиреальные сцены занимают промежуточное положение между реальными и полностью синтетическими.

---

#### Сцены и изображения, построенные с помощью компьютера

Компьютерные (синтетические) сцены — это сцены, полностью задаваемые математически и создаваемые средствами компьютерного моделирования.

Компьютерные изображения формируются:
- по строго заданным моделям объектов;
- без прямой связи с реальными сценами;
- с заранее известными параметрами и структурой.

Особенности:
- отсутствуют реальные физические шумы (если специально не добавлены);
- полностью контролируемые характеристики;
- высокая воспроизводимость.

Назначение:
- теоретический анализ алгоритмов;
- проверка корректности математических моделей;
- исследование предельных возможностей методов обработки.

Такие сцены используются в качестве эталонных или тестовых данных.

---

Три типа сцен — реальные, квазиреальные и компьютерные — различаются по степени приближения к действительности и назначению. Реальные сцены используются для практического дешифрирования, квазиреальные — для моделирования и тестирования методов, а компьютерные — для теоретических исследований и проверки алгоритмов в полностью контролируемых условиях.

---

### 2.3 Аддитивный шум

Аддитивный шум является одной из основных помех, искажающих цифровые изображения. Его учёт и подавление — ключевая задача цифровой обработки изображений и автоматического дешифрирования.

---

#### Определение аддитивного шума

Аддитивный шум — это шум, который накладывается на полезный сигнал путём сложения и не зависит от значения самого сигнала.

Математически изображение с аддитивным шумом описывается как:
$$
Y(i,j) = X(i,j) + N(i,j),
$$
где:
- $X(i,j)$ — истинное (идеальное) изображение;
- $N(i,j)$ — аддитивный шум;
- $Y(i,j)$ — наблюдаемое изображение.

Характерные особенности аддитивного шума:
- шум не зависит от амплитуды сигнала;
- может принимать как положительные, так и отрицательные значения;
- статистические свойства шума считаются известными или оцениваемыми.

Типичный пример — гауссов шум, возникающий в электронных компонентах фотоприёмников.

Основные источники:
- тепловые шумы электронных схем;
- шумы фотоприёмных устройств;
- шумы усилителей и аналого-цифровых преобразователей;
- внешние электромагнитные помехи.

Аддитивный шум присутствует практически во всех реальных системах формирования изображений.

---

#### Измерение аддитивного шума

Измерение шума заключается в оценке его статистических характеристик.

Основные параметры:
- математическое ожидание (часто предполагается равным нулю);
- дисперсия или среднеквадратичное отклонение;
- спектральные характеристики.

Методы измерения:
- анализ однородных участков изображения (фон);
- вычитание усреднённого изображения;
- оценка дисперсии разности соседних пикселей.

В предположении нулевого среднего:
$$
σ_N^2 = E[N^2(i,j)]
$$
Чем больше дисперсия шума, тем сильнее искажение изображения.

Аддитивный шум:
- снижает контраст и чёткость изображения;
- маскирует мелкие детали;
- ухудшает эффективность сегментации и распознавания;
- увеличивает ошибки при дешифрировании.

Особенно сильно шум влияет на:
- точечные и малоконтрастные объекты;
- границы между объектами;
- текстурные признаки.

---

#### Снижение аддитивного шума

Снижение (подавление) аддитивного шума осуществляется методами фильтрации и статистической обработки.

1. Пространственные методы
    - усредняющие (сглаживающие) фильтры;
    - линейная фильтрация;
    - свёртка с низкочастотными масками.

   Недостаток — возможное размывание границ.


2. Статистические методы
   - оптимальные линейные фильтры; 
   - фильтр Винера; 
   - адаптивная фильтрация.

    Эти методы используют статистические характеристики сигнала и шума


3. Частотные методы
   - подавление высокочастотных составляющих; 
   - фильтрация в спектральной области.

    Основаны на различии спектров полезного сигнала и шума.

---

## 3. Признаки объектов

### 3.1 Признаки объектов

В задачах цифровой обработки изображений и дешифрирования объектов основным инструментом анализа являются признаки объектов, которые позволяют перейти от исходного изображения к количественному описанию объектов и их свойств.

---

#### Определение признака

Признак объекта — это числовая характеристика, вычисляемая по значениям изображения, принадлежащим объекту, и отражающая одно из его существенных свойств.

Формально признак представляет собой функцию:
$$
f_A(x_A)
$$

где:
- $A$ — множество пикселей, принадлежащих объекту;
- $x_A =\{x_z | z ∈ A \}$ — значения яркости (или другой характеристики) в этих пикселях;
- $f_A$ — функция, сопоставляющая объекту числовое значение.

Признаки используются для:
- описания объектов;
- сравнения и различения объектов;
- классификации и распознавания.

---

#### Пример признака: средняя яркость объекта

Рассмотрим признак:
$$
f_A(x_A) = \frac{1}{|A|} \sum_{z ∈ A}x_z
$$
Здесь:
- $|A|$ — количество пикселей объекта (площадь объекта);
- $x_z$ — значение яркости в пикселе $z$.

Физический смысл - этот признак определяет среднюю яркость объекта.

Свойства:
- отражает амплитудные характеристики объекта;
- устойчив к случайным шумам при большом размере объекта;
- широко используется при сегментации и классификации.

Применение:
- различение объектов по уровню яркости;
- обнаружение локально однородных областей;
- оценка отражательной способности объекта.

---

#### Пример признака: площадь объекта

Рассмотрим признак:
$$
f_A(x_A) = |A|
$$
Здесь:
- $|A|$ — количество элементов множества $A$.

Физический смысл - этот признак определяет площадь объекта в пикселях.

Свойства:
- относится к геометрическим признакам;
- не зависит от значений яркости;
- чувствителен к масштабу изображения.

Применение:
- классификация объектов по размерам;
- отсеивание мелких шумовых объектов;
- анализ формы и структуры сцены.

---

#### Роль признаков в анализе объектов

Признаки позволяют:
- перейти от изображения к вектору признаков;
- сравнивать объекты в числовом пространстве;
- использовать математические и статистические методы распознавания.

На практике для одного объекта формируется набор признаков, включающий:
- амплитудные;
- геометрические;
- текстурные;
- спектральные признаки.

---

### 3.2 Признак формы

Признаки формы используются для описания геометрической структуры объекта и позволяют различать объекты, имеющие схожие амплитудные характеристики, но различающиеся по контуру и пространственной организации.

---

#### Определение признака формы

Признак формы — это числовая характеристика, описывающая геометрическую форму объекта независимо (или слабо зависимо) от его положения, ориентации и масштаба.

Форма объекта определяется:

- конфигурацией его границы;
- распределением точек внутри области;
- соотношением геометрических параметров.

Признаки формы строятся на основе множества пикселей, принадлежащих объекту, или его контура.

Хороший признак формы должен обладать:
- инвариантностью к сдвигу;
- инвариантностью к повороту;
- инвариантностью (или нормируемостью) к масштабу;
- устойчивостью к шумам и небольшим искажениям границы.

Эти свойства позволяют корректно сравнивать формы различных объектов.

---

#### Сравнение объектов по форме

Сравнение по форме заключается в сопоставлении признаков формы двух или более объектов.

Основные подходы:
- сравнение геометрических коэффициентов (компактность, вытянутость);
- сравнение распределений точек относительно центра;
- сравнение контуров;
- сравнение гистограмм ориентаций.

Сравнение может выполняться:
- по расстоянию между векторами признаков;
- по статистическим критериям.

---

#### Гипотеза однородности формы

При статистическом сравнении форм вводится гипотеза однородности.

Гипотеза однородности $H_0$:
объекты принадлежат одному классу и имеют одинаковое распределение признаков формы.

Альтернативная гипотеза $H_1$:
распределения признаков формы различаются, и объекты принадлежат разным классам.

---

#### Критерий хи-квадрат (χ²)

Критерий хи-квадрат используется для проверки гипотезы однородности распределений признаков.

Если признак формы представлен в виде гистограммы (например, распределение ориентаций или расстояний от центра), то статистика критерия имеет вид:
$$
X^2 = \sum_{k=1}^n \frac{(O_k - E_k)^2}{E_k}
$$
где:
- $O_k$ — наблюдаемое количество элементов в $k$-й группе;
- $E_k$ — ожидаемое количество элементов при выполнении гипотезы $H_0$;
- $n$ — число групп (интервалов).

Правило принятия решения:
- если $X^2 ≤ X_{кр}^2$, гипотеза $H_0$ принимается;
- если $X^2 > X_{кр}^2$, гипотеза $H_0$ отвергается.

---

#### Роль признака формы в дешифрировании

Признаки формы:
- дополняют амплитудные и текстурные признаки;
- особенно эффективны для распознавания искусственных объектов;
- позволяют отличать объекты с одинаковой яркостью, но разной геометрией.

Критерий $X^2$ обеспечивает строгую статистическую основу для сравнения форм объектов.

---

## 4. Сегментация

### 4.1 Зона интереса и ее применение

#### Определение зоны интереса

Зона интереса (ROI — Region of Interest) — это часть изображения или сцены, содержащая информацию, существенную для решения конкретной задачи обработки или дешифрирования.

Формально:
- изображение рассматривается как случайное поле $X=\{x_z, z ∈ Z^2\};$
- зона интереса — это подмножество узлов $A \subset Z^2$ в пределах которого сосредоточена полезная информация об объекте или гипотезе.

Пиксели вне зоны интереса рассматриваются как:
- неинформативные;
- фоновые;
- не влияющие на принятие решения.

Использование зоны интереса позволяет:
- сократить объём обрабатываемых данных;
- уменьшить вычислительную сложность алгоритмов;
- повысить устойчивость к шумам фона;
- сосредоточить анализ на информативных областях изображения.

Зона интереса широко применяется при:
- обнаружении объектов;
- распознавании и классификации;
- отслеживании объектов;
- предварительной сегментации.

---

#### Формулировка теоремы

Теорема о зоне интереса формулируется следующим образом:
> Если задача принятия решения (обнаружение, классификация, распознавание) зависит только от значений изображения в некоторой области $A$, то существует оптимальное правило принятия решения, использующее только значения случайного поля внутри зоны интереса $A$.

Иначе говоря:
- значения изображения вне зоны интереса не содержат дополнительной информации, полезной для решения задачи;
- их учёт не улучшает качество оптимального решения.

**Математическая интерпретация**

Пусть:
- $X_A = \{x_z, z \in A\}$ — значения изображения в зоне интереса;
- $X_{Z^2/A}$ — значения вне зоны интереса.

Если условные распределения удовлетворяют:
$$
p(X|H) = p(X_A|H)\cdot p(X_{Z^2/A})
$$
то оптимальное решение по гипотезе $H$ зависит только от $X_A$.

Следствия теоремы:
- обработка изображения может быть ограничена зоной интереса без потери информации;
- анализ фона не улучшает результат;
- возможно построение локальных алгоритмов дешифрирования.

Это является теоретическим обоснованием:
- локальной обработки изображений;
- оконных методов;
- применения скользящих масок и фильтров.

---

### 4.2 Сегментация простой зоны

#### Определение простой зоны и признаки

Простая зона — это область изображения, в пределах которой амплитуды (яркости) пикселей являются статистически однородными и могут быть описаны одной случайной величиной.

Формально:
- зона $A \subset Z^2$;
- значение $x_z, z \in A$, являются реализациями одной и той же случайной величины.

Характерные особенности простой зоны:
- малая дисперсия амплитуд;
- отсутствие выраженной текстуры;
- одномодальное распределение яркости.

Для описания простой зоны используются амплитудные признаки:
- оценка среднего значения яркости:
$$
\mu = \frac{1}{|A|} \sum_{z \in A} x_z
$$
- оценка дисперсии:
$$
σ^2 = \frac{1}{|A|} \sum_{z \in A} (x_z - \mu)^2
$$
Эти признаки позволяют статистически описать однородность зоны.

---

#### Оценка границ интервала амплитуд с помощью неравенства Чебышёва

Для оценки допустимого диапазона амплитуд используется неравенство Чебышёва.

Формулировка неравенства Чебышёва:
> Для любой случайной величины $X$ с математическим ожиданием $\mu$ и дисперсией $σ^2$:
$$ P\{|X-\mu| ≥ kσ \} ≤ \frac{1}{k^2} $$

Применение к простой зоне:

С заданной вероятностью значения яркости принадлежат интервалу:
$$
\mu - kσ ≤ x_z ≤ \mu + kσ
$$
Параметр $k$:
- задаёт ширину интервала;
- определяет компромисс между точностью и надёжностью сегментации.

---

#### Решающее правило сегментации

Решающее правило определяет принадлежность пикселя зоне.

Пиксель $z$ относится к простой зоне $A$, если:
$$
|x_z - \mu| ≤ kσ
$$
Если условие не выполняется — пиксель относится к другой зоне или фону.

Особенности правила:
- простота реализации;
- локальный характер;
- основано на статистических оценках.

---

#### Ошибка классификации

При сегментации возможны ошибки двух типов:

Ошибка первого рода:
- пиксель простой зоны ошибочно отнесён к другой зоне.

Ошибка второго рода:
- пиксель другой зоны ошибочно отнесён к данной простой зоне.

Вероятность ошибки зависит от:
- выбранного значения $k$;
- точности оценки $μ$ и $σ$;
- уровня шума.

Неравенство Чебышёва даёт верхнюю оценку вероятности ошибки, но не точное значение.

---

## 5. Обнаружение объектов

### 5.1 Обнаружение точечных объектов по скалярным изображениям

#### Исходные предположения

При обнаружении точечных объектов принимаются следующие предположения:

1. Изображение является скалярным, то есть каждому пикселю соответствует одно амплитудное значение (яркость).

2. Точечный объект занимает один пиксель или область, сравнимую с размером элемента разрешения.

3. Фон является локально однородным и может быть описан случайной величиной с параметрами:
   - математическое ожидание $\mu_f$;
   - дисперсия $𝜎_f^2$.

4. Значения яркости фона и объекта статистически независимы.

5. Аддитивный шум присутствует и входит в модель фона.

Таким образом, задача сводится к различению двух гипотез:
- $𝐻_0$: в пикселе присутствует только фон;
- $H_1$: в пикселе присутствует точечный объект.

---

#### Построение интервала амплитуд фона с помощью неравенства Чебышёва

Для фона используется неравенство Чебышёва.

Формулировка:
$$
P\{|X-\mu_f|≥kσ_f\} ≤ \frac{1}{k^2}
$$

Отсюда следует, что с вероятностью не менее $1 - \frac{1}{k^2}$ амплитуда фона принадлежит интервалу:
$$
\mu_f - kσ_f ≤ x ≤ \mu_f + kσ_f
$$
Этот интервал интерпретируется как допустимый диапазон амплитуд фона.

---

#### Решающее правило обнаружения

Решающее правило формулируется следующим образом:
- если наблюдаемая амплитуда пикселя $x_z$ выходит за пределы интервала фона:
$$
x_z > \mu_f + kσ_f  
$$
$$
или
$$
$$
x_z < \mu_f - kσ_f  
$$
— принимается гипотеза $H_1$ (обнаружен точечный объект);

-  если:
$$
\mu_f - kσ_f ≤ x_z ​≤ \mu_f + kσ_f
$$
— принимается гипотеза $H_0$ (фон).

На практике часто используется односторонний критерий (объект ярче фона).

---

#### Вероятность ложного обнаружения

Вероятность ложного обнаружения — это вероятность принятия гипотезы $H_1$ при отсутствии объекта, то есть:
$$
P_л = P(принято H_1 | H_0)
$$
Согласно неравенству Чебышёва:
$$
P_л ≤ \frac{1}{k^2}
$$
Таким образом:
- параметр $k$ напрямую управляет уровнем ложных тревог;
- при увеличении $k$ вероятность ложного обнаружения уменьшается;
- одновременно снижается чувствительность обнаружения.

Выбор параметра $k$ определяет компромисс между:
- вероятностью ложного обнаружения;
- вероятностью пропуска объекта.

Слишком малое $k$:
- высокая чувствительность;
- много ложных срабатываний.

Слишком большое $k$:
- низкая вероятность ложного обнаружения;
- высокий риск пропуска слабых объектов.

---

Обнаружение точечных объектов по скалярным изображениям основано на статистическом описании фона и использовании неравенства Чебышёва для построения допустимого интервала амплитуд. Решающее правило заключается в выявлении пикселей, выходящих за пределы этого интервала. Вероятность ложного обнаружения имеет гарантированную верхнюю оценку, зависящую от выбранного порога.

---

### 5.2 Обнаружение точечных объектов по векторным изображениям

#### Векторные сцены и векторные изображения

Векторная сцена — это сцена, в которой каждому элементу разрешения соответствует вектор измерений, полученных в разных каналах.

Векторное изображение — это изображение, в котором каждому пикселю сопоставляется вектор:
$$
x_z = (x_{z1}, x_{z2}, ..., x_{zm})
$$
где $m$ - число спектральных, поляризационных или временных каналов.

Примеры:
- многоспектральные и гиперспектральные изображения;
- изображения в разных диапазонах длин волн;
- комплексные измерения.

---

#### Исходные предположения

При обнаружении точечных объектов по векторным изображениям предполагается:
1. Фон векторного изображения является локально однородным.
2. Вектор яркостей фона описывается случайным вектором $с$:
   - вектором математических ожиданий $\mu_f$;
   - ковариационной матрицей $C_f$.
3. Влияние шума аддитивное и входит в модель фона.
4. Значения в разных каналах могут быть коррелированными.
5. Точечный объект изменяет вектор амплитуд по сравнению с фоном.

Рассматриваются гипотезы:
- $H_0$: вектор соответствует фону;
- $H_1$: вектор соответствует объекту.

---

#### Построение эллипса амплитуд фона

В векторном пространстве допустимая область значений фона имеет форму эллипса (в общем случае — эллипсоида).

Эллипс фона задаётся неравенством:
$$
(x - \mu_f)^TC_f^{-1}(x-\mu_f)≤\lambda
$$
где:
- $\mu_f$ — средний вектор фона;
- $C_f$ — ковариационная матрица;
- $λ$ — пороговый параметр.

Геометрически:
- центр эллипса — $\mu_f$;
- форма и ориентация эллипса определяются корреляциями каналов.

---

#### Решающее правило обнаружения

Решающее правило формулируется следующим образом:

- если вектор наблюдения $x_z$ лежит внутри эллипса, принимается гипотеза $H_0$ (фон);
- если $x_z$ лежит вне эллипса, принимается гипотеза $H_1$ (обнаружен точечный объект).

Функция:
$$
D(x) = (x - \mu_f)^TC_f^{-1}(x-\mu_f)
$$
служит решающей статистикой.

---

#### Вероятность ложного обнаружения

Вероятность ложного обнаружения:
$$
P_л = P(D(x) > \lambda | H_0)
$$
При отсутствии предположений о виде распределения фона используется обобщённое неравенство Чебышёва:
$$
P_л ≤ \frac{m}{\lambda}
$$
где $m$ - размерность вектора

Следствия:
- увеличение $𝜆$ уменьшает вероятность ложного обнаружения;
- рост размерности увеличивает риск ложных тревог при фиксированном пороге.

---

Обнаружение точечных объектов по векторным изображениям основано на статистическом описании фона в многомерном пространстве. Допустимая область фона задаётся эллипсом, определяемым средним вектором и ковариационной матрицей. Решающее правило сводится к проверке принадлежности вектора наблюдений этому эллипсу, а вероятность ложного обнаружения имеет гарантированную верхнюю оценку.

---
